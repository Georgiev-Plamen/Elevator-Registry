<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Inspection</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <script>
        function updateInspectionDates() {
            const elevatorsSelect = document.getElementById('elevators');
            const selectedOption = elevatorsSelect.options[elevatorsSelect.selectedIndex];

            const lastInspectionField = document.getElementById('lastInspection');
            const lastInspectionDate = selectedOption.getAttribute('data-last-inspection');
            lastInspectionField.value = lastInspectionDate ? lastInspectionDate : '';

            const nextInspectionField = document.getElementById('nextInspection');
            const nextInspectionDate = selectedOption.getAttribute('data-next-inspection');
            nextInspectionField.value = nextInspectionDate ? nextInspectionDate : '';

            const addressField = document.getElementById('address');
            const address = selectedOption.getAttribute('data-address');
            addressField.value = address ? address : '';


            const manufacturerNumberField = document.getElementById('manufacturerNumber');
            const manufacturerNumber = selectedOption.getAttribute('data-manufacturer-number');
            manufacturerNumberField.value = manufacturerNumber ? manufacturerNumber : '';

            const customerField = document.getElementById('customer');
            const customer = selectedOption.getAttribute('data-customer-id');
            customerField.value = customer ? customer : '';

        }

        window.addEventListener('DOMContentLoaded', (event) => {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById("inspectionDate").value = today;
        });
    </script>

</head>
<body>
<div th:replace="~{fragments/navbar::navbar(activeLink=${'home'})}"></div>

<div class="container">
    <h1>Add Inspection</h1>
    <form th:action="@{/inspection/addInspection}" th:method="POST">

<!--        <label for="customers">Customer:</label>-->
<!--        <select id="customers" name="customers" onchange="updateInspectionDates()">-->
<!--            <option selected>-== Chose customer ==-</option>-->
<!--            <option th:each="customer : ${customers}"-->
<!--                    th:value="${customer.id()}"-->
<!--                    th:text="|${customer.name()} - ${customer.vat()}|"-->
<!--                    required>customer</option>-->
<!--        </select>-->

        <label for="elevators">Elevators:</label>
        <select id="elevators" name="elevators" onchange="updateInspectionDates()">
            <option selected>-== Chose elevator ==-</option>
            <option th:each="elevator : ${elevators}"
                    th:value="${elevator.id()}"
                    th:text="|${elevator.manufacturer()} - ${elevator.manufacturerNumber()} - ${elevator.address()}|"
                    th:data-last-inspection="${elevator.lastInspection()}"
                    th:data-next-inspection="${elevator.nextInspection()}"
                    th:data-manufacturer-number="${elevator.manufacturerNumber()}"
                    th:data-address="${elevator.address()}"
                    th:data-customer-id="${elevator.owner().id}"
                    required>elevator</option>
        </select>


        <input type="hidden" id="customer" name="customer" required><br><br>

        <label for="lastInspection">Last inspection:</label>
        <input type="date" id="lastInspection" name="lastInspection" required><br><br>

        <label for="nextInspection">Next inspection:</label>
        <input type="date" id="nextInspection" name="nextInspection" required><br><br>
        <!--//TODO:-->
        <label for="manufacturerNumber">Manufacturer number:</label>
        <input type="text" id="manufacturerNumber" name="manufacturerNumber" required><br><br>

        <label for="address">Address:</label>
        <input type="text" id="address" name="address" required><br><br>

        <label for="price">Price:</label>
        <input type="number" id="price" name="price" required><br><br>

        <label for="inspectionDate">Inspection date:</label>
        <input type="date" id="inspectionDate" name="inspectionDate" required><br><br>

        <button type="submit">Add inspection</button>
    </form>
</div>
</body>
</html>
